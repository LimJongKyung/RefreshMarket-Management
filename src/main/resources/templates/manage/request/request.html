<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      class="h-100" data-bs-theme="auto">
<head>
<meta charset="UTF-8">
<title>요청 리스트</title>
<th:block th:insert="~{template/fragments/block :: config}"></th:block>
<link href="/css/main.css" rel="stylesheet">
<link href="/css/requestCSS/requestList.css" rel="stylesheet">
</head>
<body>
	<th:block th:insert="~{template/fragments/block :: header}"></th:block>
	<th:block th:insert="~{template/fragments/block :: logo}"></th:block>
    <th:block th:insert="~{template/fragments/block :: mainMenu}"></th:block>

    <div class="layout-container">
	    <th:block th:insert="~{template/fragments/block :: sideMenu}"></th:block>

	    <!-- 본문 영역 -->
	    <main class="request flex-grow-1 d-flex justify-content-center align-items-start py-5">
		    <div class="container col-lg-8 bg-white p-4 rounded shadow-sm">
		        <h1 class="text-center mb-4">요청 리스트</h1>

		        <!-- 검색 폼 -->
		        <form action="#" th:action="@{/requests}" method="get"
		              class="search-form mb-4 d-flex justify-content-center gap-2">
		            <input type="text" name="keyword" class="form-control w-50"
		                   placeholder="이름 또는 이메일 검색" th:value="${keyword}" />
		            <button type="submit" class="btn btn-primary">검색</button>
		        </form>

		        <!-- 목록 테이블 -->
		        <div class="table-responsive">
				    <table class="table table-hover table-bordered align-middle text-center">
				        <thead class="table-light">
				            <tr>
				                <th>요청 ID</th>
				                <th>이름</th>
				                <th>이메일</th>
				                <th>상담 유형</th>
				                <th>요청 날짜</th>
				            </tr>
				        </thead>
				        <tbody>
				            <tr th:each="request : ${requestPage.content}">
				                <!-- 요청 ID (링크 없음) -->
				                <td th:text="${request.requestId}">1</td>
				
				                <!-- 이름 (상세 페이지 링크) -->
				                <td>
				                    <a th:href="@{'/requests/' + ${request.requestId}}"
				                       th:text="${request.consultantName}"
				                       class="text-decoration-none text-primary"></a>
				                </td>
				
				                <!-- 이메일 (상세 페이지 링크) -->
				                <td>
				                    <a th:href="@{'/requests/' + ${request.requestId}}"
				                       th:text="${request.consultantEmail}"
				                       class="text-decoration-none text-primary"></a>
				                </td>
				
				                <td th:text="${request.consultationType}">문의</td>
				                <td th:text="${#temporals.format(request.requestDate, 'yyyy-MM-dd HH:mm')}"></td>
				            </tr>
				            <tr th:if="${#lists.isEmpty(requestPage.content)}">
				                <td colspan="5" class="text-center">데이터가 없습니다.</td>
				            </tr>
				        </tbody>
				    </table>
				</div>

		        <!-- 페이징 -->
		        <div class="pagination d-flex justify-content-center align-items-center gap-3 mt-4">
		            <a th:if="${requestPage.hasPrevious()}"
		               th:href="@{/requests(page=${requestPage.number - 1}, keyword=${keyword})}"
		               class="btn btn-outline-secondary btn-sm">이전</a>
		            <span>페이지 [[${requestPage.number + 1}]] / [[${requestPage.totalPages}]]</span>
		            <a th:if="${requestPage.hasNext()}"
		               th:href="@{/requests(page=${requestPage.number + 1}, keyword=${keyword})}"
		               class="btn btn-outline-secondary btn-sm">다음</a>
		        </div>
		    </div>
		</main>
	</div>

	<th:block th:insert="~{template/fragments/block :: footer}"></th:block>
</body>
</html>